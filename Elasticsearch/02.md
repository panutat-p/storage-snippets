# CRUD

## Insert

https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-index_.html

```sh
POST /fruits/_doc/1
{
  "name": "apple",
  "color": "red",
  "price": "15",
  "tag": ["fruit"]
}
```

## Update

https://www.elastic.co/guide/en/elasticsearch/reference/current/docs-update.html

```sh
POST /fruits/_update/1
{
  "doc": {
    "price": "100"
  }
}
```

* `refresh=false` default
* `refresh=true` force Elasticsearch to refresh the relevant shard immediately
* `refresh=wait_for` wait for the next scheduled refresh

```sh
POST /fruits/_update/1?refresh=wait_for
{
  "doc": {
    "price": 100
  }
}
```

## Search

```sh
GET /fruits/_search
```

## Filter

```sh
GET /fruits/_search?filter_path=hits.hits._source
```

```sh
GET /fruits/_search
{
  "query": {
    "bool": {
      "filter": [
        {"term": {"color": "green"}}
      ]
    }
  }
}
```

```shell
GET /fruits/_search
{
  "query": {
    "bool": {
      "filter": [
        {"terms": {"color": ["green", "red"]}}
      ]
    }
  }
}
```

## Range

```sh
GET /fruits/_search
{
  "query": {
    "bool": {
      "must": [
        {"range": {"price": {"gte": 10}}}
      ]
    }
  }
}
```

## Delete all

```sh
POST /fruits/_delete_by_query
{
  "query": {
    "match_all": {}
  }
}
```

```sh
POST /fruits/_delete_by_query
{
  "query": {
    "bool": {
      "must": [
        {
          "term": {"name": "apple"}
        }
      ]
    }
  }
}
```
