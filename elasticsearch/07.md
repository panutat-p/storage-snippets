# Clone

## Prepare index

```shell
PUT /fruits_old
{
    "mappings": {
        "properties": {
            "name": {
                "type": "text"
            },
            "price": {
                "type": "integer"
            },
            "tag": {
                "type": "text"
            }
        }
    }
}
```

```shell
PUT /fruits_old
{
  "settings": {
    "index": {
      "number_of_shards": 1,  
      "number_of_replicas": 1
    }
  },
   "mappings":{
      "dynamic":false,
      "properties": {
            "name": {"type": "text"},
            "color": {"type": "keyword"},
            "price": {"type": "integer"},
            "tags": {"type": "keyword"}
        }
   }
}
```

```shell
POST /fruits_old/_bulk
{ "index" : { "_id" : "1" } }
{"name": "apple", "color": "red", "price": 15,"tags": ["fruit"]}
{ "index" : { "_id" : "2" } }
{"name": "banana","color": "yellow", "price": 8,"tags": ["fruit"]}
{ "index" : { "_id" : "3" } }
{"name": "carrot","color": "orange", "price": 10,"tags": ["fruit"]}
{ "index" : { "_id" : "4" } }
{"name": "durian","color": "green", "price": 100,"tags": ["fruit","premium"]}
{ "index" : { "_id" : "5" } }
```

## Block

```shell
PUT /fruits_old/_settings
{
  "index": {
    "blocks.read_only": true
  }
}
```

## Clone

```shell
POST /fruits_old/_clone/fruits_new
```

## Unblock

```shell
PUT /fruits_old/_settings
{
  "index": {
    "blocks.read_only": false
  }
}
```

```shell
PUT /fruits_new/_settings
{
  "index": {
    "blocks.read_only": false
  }
}
```

## Search

```shell
GET /fruits_old/_search
```

```shell
GET /fruits_new/_search
```
